const express = require('express');
const router = express.Router();
const Room = require('../models/Room');
const roomTypeController = require('../controllers/roomTypeController');
const { asyncHandler } = require('../utils');

// POST endpoint for creating rooms
router.post('/api/v1/rooms', async (req, res) => {
  try {
    const { name, roomType, price } = req.body;
    const newRoom = new Room({ name, roomType, price });
    await newRoom.save();
    res.status(201).json({ message: 'Room created successfully', data: newRoom });
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: 'Internal server error' });
  }
});

// GET endpoint for fetching all room types
router.get('/api/v1/rooms-types', async (req, res) => {
  try {
    const roomTypes = await RoomType.find(); // Corrected variable name to RoomType
    res.status(200).json({ data: roomTypes });
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: 'Internal server error' });
  }
});

// Router POST method for creating room types
router.post('/api/v1/room-types', asyncHandler(roomTypeController.createRoomType));

// Router GET method for all room types 
router.get('/api/v1/room-types', asyncHandler(roomTypeController.getAllRoomTypes));

// Router GET method for getting room types by id 
router.get('/api/v1/room-types/:id', asyncHandler(roomTypeController.getRoomTypeById));

// Router PATCH method for updating rooms 
router.patch('/api/v1/room-types/:id', asyncHandler(roomTypeController.updateRoomTypeById));

// Router DELETE methods for deleting rooms
router.delete('/api/v1/room-types/:id', asyncHandler(roomTypeController.deleteRoomTypeById));

module.exports = router;
